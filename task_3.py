def calculate_probability():
    """
    Решение задачи о Золушке и мачехе
    
    Анализ вероятности, что мачеха не соблазнится поднять руку на Золушку
    при потере дочерью монет.
    """
    
    # Вероятности потери монет
    p_lose_2_ruble = 0.5    # Вероятность потерять монету в 2 рубля
    p_lose_5_ruble = 0.2    # Вероятность потерять монету в 5 рублей
    
    # Варианты потерь и их вероятности
    print("ЗАДАЧА О ЗОЛУШКЕ И МАЧЕХЕ")
    print("=" * 60)
    print("У дочери есть 2 монеты: 2 рубля и 5 рублей")
    print(f"Вероятность потери 2-рублевой монеты: {p_lose_2_ruble}")
    print(f"Вероятность потери 5-рублевой монеты: {p_lose_5_ruble}")
    print("(события независимы)")
    print()
    
    # Рассмотрим все возможные комбинации событий
    print("ВОЗМОЖНЫЕ КОМБИНАЦИИ СОБЫТИЙ:")
    print("-" * 60)
    
    # Сценарий 1: Не потеряна ни одна монета
    p1 = (1 - p_lose_2_ruble) * (1 - p_lose_5_ruble)
    print(f"1. Ни одна монета не потеряна:")
    print(f"   Вероятность: {p1:.4f} = (1-{p_lose_2_ruble}) × (1-{p_lose_5_ruble})")
    print(f"   Потеря денег: 0 рублей")
    print(f"   Реакция мачехи: спокойна (потеря < 3 рубля)")
    print()
    
    # Сценарий 2: Потеряна только 2-рублевая монета
    p2 = p_lose_2_ruble * (1 - p_lose_5_ruble)
    print(f"2. Потеряна только 2-рублевая монета:")
    print(f"   Вероятность: {p2:.4f} = {p_lose_2_ruble} × (1-{p_lose_5_ruble})")
    print(f"   Потеря денег: 2 рубля")
    print(f"   Реакция мачехи: спокойна (потеря < 3 рубля)")
    print()
    
    # Сценарий 3: Потеряна только 5-рублевая монета
    p3 = (1 - p_lose_2_ruble) * p_lose_5_ruble
    print(f"3. Потеряна только 5-рублевая монета:")
    print(f"   Вероятность: {p3:.4f} = (1-{p_lose_2_ruble}) × {p_lose_5_ruble}")
    print(f"   Потеря денег: 5 рублей")
    print(f"   Реакция мачехи: ЗЛОСТЬ (потеря ≥ 3 рубля)")
    print(f"   -> Принц будет в ярости, если Золушку обидят")
    print()
    
    # Сценарий 4: Потеряны обе монеты
    p4 = p_lose_2_ruble * p_lose_5_ruble
    print(f"4. Потеряны обе монеты:")
    print(f"   Вероятность: {p4:.4f} = {p_lose_2_ruble} × {p_lose_5_ruble}")
    print(f"   Потеря денег: 7 рублей")
    print(f"   Реакция мачехи: ЗЛОСТЬ (потеря ≥ 3 рубля)")
    print(f"   -> Принц будет в ярости, если Золушку обидят")
    print()
    
    # Проверка суммы вероятностей
    total_prob = p1 + p2 + p3 + p4
    print(f"ПРОВЕРКА: Сумма всех вероятностей = {total_prob:.6f}")
    print("(должно быть равно 1.000000)")
    print()
    
    # Анализ ситуации с мачехой
    print("АНАЛИЗ РЕАКЦИИ МАЧЕХИ:")
    print("-" * 60)
    
    # События, когда мачеха НЕ будет злиться
    p_no_anger = p1 + p2  # Ничего не потеряно или потеряно только 2 рубля
    print(f"Мачеха НЕ будет злиться, если:")
    print(f"  - Не потеряна ни одна монета: P = {p1:.4f}")
    print(f"  - Потеряна только 2-рублевая монета: P = {p2:.4f}")
    print(f"  Общая вероятность: {p_no_anger:.4f}")
    print()
    
    # События, когда мачеха БУДЕТ злиться
    p_anger = p3 + p4  # Потеряна 5-рублевая монета (с 2-рублевой или без)
    print(f"Мачеха БУДЕТ злиться, если:")
    print(f"  - Потеряна 5-рублевая монета (с 2-рублевой или без):")
    print(f"    * Только 5-рублевая: P = {p3:.4f}")
    print(f"    * Обе монеты: P = {p4:.4f}")
    print(f"  Общая вероятность: {p_anger:.4f}")
    print()
    
    # Ключевой вывод из инструкции
    print("КЛЮЧЕВОЙ ВЫВОД ИЗ ИНСТРУКЦИИ:")
    print("-" * 60)
    print("Потеря 2-рублевой монеты (< 3 рублей): мачеха просто махнет рукой")
    print("Потеря 5-рублевой монеты (≥ 3 рублей): мачеха разозлится")
    print()
    print(f"Вероятность потери 5-рублевой монеты = {p_lose_5_ruble}")
    print(f"Вероятность НЕ потери 5-рублевой монеты = {1 - p_lose_5_ruble}")
    print()
    print(f"Принц разозлится, если мачеха ударит Золушку")
    print(f"Мачеха ударит, если дочь потеряет ≥ 3 рублей")
    print(f"Вероятность, что дочь потеряет ≥ 3 рублей = {p_anger:.4f}")
    print(f"Вероятность, что дочь НЕ потеряет ≥ 3 рублей = {p_no_anger:.4f}")
    print()
    
    # Ответ на вопрос задачи
    print("ОТВЕТ НА ВОПРОС ЗАДАЧИ:")
    print("=" * 60)
    print(f"Вероятность, что мачеха не соблазнится поднять руку на Золушку:")
    print(f"P = {p_no_anger:.4f}")
    print()
    print("ПОЯСНЕНИЕ:")
    print("Мачеха ударит Золушку, если ее дочь потеряет 5 рублей или больше.")
    print("Это происходит в двух случаях:")
    print("1. Потеряна только 5-рублевая монета (вероятность {p3:.4f})")
    print("2. Потеряны обе монеты (вероятность {p4:.4f})")
    print(f"Общая вероятность удара: {p_anger:.4f}")
    print()
    print(f"Следовательно, вероятность, что мачеха НЕ ударит Золушку:")
    print(f"P = 1 - {p_anger:.4f} = {p_no_anger:.4f}")
    print()
    print("ПРИМЕЧАНИЕ:")
    print("Из инструкции: 'Вероятность 0.2 потери 5-рублевой монеты'")
    print("равна вероятности, что мачеха разозлится.")
    print(f"Действительно, {p_lose_5_ruble} = {p_anger:.4f}")
    print(f"Таким образом, P(не ударит) = 1 - {p_lose_5_ruble} = {1-p_lose_5_ruble:.4f}")
    
    return p_no_anger, p_anger

# Запуск расчета
if __name__ == "__main__":
    p_safe, p_danger = calculate_probability()
    
    print("\n" + "=" * 60)
    print("ИНТЕРЕСНЫЙ ФАКТ:")
    print("Если бы мачеха реагировала на любую потерю (даже 2 рубля),")
    print(f"вероятность удара была бы: {0.5 + 0.2 - 0.5*0.2:.4f}")
    print("(по формуле вероятности объединения независимых событий)")
    print("Но она реагирует только на потери ≥ 3 рублей.")